import { applyParamsToScript, Assets, Constr, Data, Lucid, PlutusData, Script } from 'lucid-cardano'

// Script Stuff.
const fracadaScript = '59179b5917980100003323322333222332233223232333222323332223233333333222222223233322232333322223232332232333222323232332233223232333332222233223322332233223322332222323232322232325335303233300a3333573466e1cd55cea8042400046666444466660a0008006004002666aa08eeb9d71aba15008375a6ae85401ccd4075d71aba15006375a6ae84d5d1280311a8241a982499ab9c491035054310004a499263333573466e1cd55ce9baa0044800081288d4120d4c124cd5ce249035054310004a499263333573466e1cd55cea8012400046601a64646464646464646464646666ae68cdc39aab9d500a480008cccccccccc06ccd40a48c8c8cccd5cd19b8735573aa0049000119810981c9aba15002302e357426ae8940088d4160d4c164cd5ce249035054310005a49926135573ca00226ea8004d5d0a80519a8148151aba150093335503075ca05e6ae854020ccd540c1d728179aba1500733502904235742a00c66a05266aa0a6096eb4d5d0a8029919191999ab9a3370e6aae754009200023350233232323333573466e1cd55cea80124000466a05666a082eb4d5d0a80118231aba135744a00446a0b86a60ba66ae712401035054310005e49926135573ca00226ea8004d5d0a8011919191999ab9a3370e6aae7540092000233502933504175a6ae854008c118d5d09aba2500223505c35305d3357389201035054310005e49926135573ca00226ea8004d5d09aba250022350583530593357389201035054310005a49926135573ca00226ea8004d5d0a80219a814bae35742a00666a05266aa0a6eb88004d5d0a801181c1aba135744a00446a0a86a60aa66ae71241035054310005649926135744a00226ae8940044d5d1280089aba25001135744a00226ae8940044d5d1280089aba25001135573ca00226ea8004d5d0a8011919191999ab9a3370ea002900311810181d1aba135573ca00646666ae68cdc3a801240084603e60886ae84d55cf280211999ab9a3370ea00690011180f98179aba135573ca00a46666ae68cdc3a80224000460446eb8d5d09aab9e500623504f3530503357389201035054310005149926499264984d55cea80089baa001357426ae8940088d4120d4c124cd5ce249035054310004a499261049135047353048335738920103505435000494984d55cf280089baa001135744a00226ae8940044d55cf280089baa0012212330010030022001222222222212333333333300100b00a00900800700600500400300220012212330010030022001122123300100300212001122123300100300212001122123300100300212001212222300400521222230030052122223002005212222300100520011232230023758002640026aa06c446666aae7c004940d88cd40d4c010d5d080118019aba200203023232323333573466e1cd55cea801a4000466600e6464646666ae68cdc39aab9d5002480008cc034c0b8d5d0a80119a8080151aba135744a00446a0666a606866ae712401035054310003549926135573ca00226ea8004d5d0a801999aa805bae500a35742a00466a018eb8d5d09aba2500223502f353030335738921035054310003149926135744a00226aae7940044dd50009110919980080200180110009109198008018011000899aa800bae75a224464460046eac004c8004d540c088c8cccd55cf80112818919a81819aa81998031aab9d5002300535573ca00460086ae8800c0ac4d5d080089119191999ab9a3370ea002900011a80418029aba135573ca00646666ae68cdc3a801240044a01046a0526a605466ae71241035054310002b499264984d55cea80089baa001121223002003112200112001232323333573466e1cd55cea8012400046600c600e6ae854008dd69aba135744a00446a0466a604866ae71241035054310002549926135573ca00226ea80048848cc00400c00880048c8cccd5cd19b8735573aa002900011bae357426aae7940088d407cd4c080cd5ce24810350543100021499261375400224464646666ae68cdc3a800a40084a00e46666ae68cdc3a8012400446a014600c6ae84d55cf280211999ab9a3370ea00690001280511a8111a981199ab9c490103505431000244992649926135573aa00226ea8004484888c00c0104488800844888004480048c8cccd5cd19b8750014800880188cccd5cd19b8750024800080188d4068d4c06ccd5ce249035054310001c499264984d55ce9baa0011220021220012001232323232323333573466e1d4005200c200b23333573466e1d4009200a200d23333573466e1d400d200823300b375c6ae854014dd69aba135744a00a46666ae68cdc3a8022400c46601a6eb8d5d0a8039bae357426ae89401c8cccd5cd19b875005480108cc048c050d5d0a8049bae357426ae8940248cccd5cd19b875006480088c050c054d5d09aab9e500b23333573466e1d401d2000230133016357426aae7940308d407cd4c080cd5ce2481035054310002149926499264992649926135573aa00826aae79400c4d55cf280109aab9e500113754002424444444600e01044244444446600c012010424444444600a010244444440082444444400644244444446600401201044244444446600201201040024646464646666ae68cdc3a800a400446660106eb4d5d0a8021bad35742a0066eb4d5d09aba2500323333573466e1d400920002300a300b357426aae7940188d4040d4c044cd5ce2490350543100012499264984d55cea80189aba25001135573ca00226ea80048488c00800c888488ccc00401401000c80048c8c8cccd5cd19b875001480088c018dd71aba135573ca00646666ae68cdc3a80124000460106eb8d5d09aab9e500423500a35300b3357389201035054310000c499264984d55cea80089baa001212230020032122300100320011122232323333573466e1cd55cea80124000466aa020600c6ae854008c014d5d09aba25002235007353008335738921035054310000949926135573ca00226ea8004498480048004888848cccc00401401000c00880044488008488488cc00401000c48004448848cc00400c008448004448c8c00400488cc00cc008008004c8ccc888c8c8cc88cc88c8ccc888c8ccc888c8c8c8c8c8ccc888ccc888cccccccc88888888cc88ccccc88888cccc8888cc88cc88cc88cc88cc88cc88cc88cc88cc88c8cc88c8c8c8c8c8cc88c8c8c8c8c8c8c8cc88c8c8c8cc88c8c8c8c8c8c8c8c8c8cccc8888cc88c8c8c8c8c8c8c8c8c8888c8d4c0880108c88894cd4c1e0ccd5cd19b895004480001e41e84cc88d4c0a402c8888d4c100018888c8c894cd4c21004ccc05802001c01854cd4c21004cc88ccd54c10448004d40bd40b88d4d5420c0400488ccd54c11048004d40c940c48d4d542180400488ccd4d540a40048cc230052000001223308d0100200123308c0100148000004cc070008004c060d4d5420005400c88008c060d4d5420004cc0a002c0148800854cd4c210054cd4c21004cc0c4d4c0cd4008888801002854cd4c21004ccd4c0c0480041d0d4c0cd4008888800802054cd4c21004ccd5cd19b873530335002222200100708601085011333573466e1cd4c0cd4008888800ccdc00049a9aa840008051119981d00180100084300842808842808842808842808999980b805a400490010060842808842808842808a99a9a83c1818299a9a83c198149a9aa83f2800910008021080089a84000a4c4200226a10002930998128040009a9aa83a2803110011a9aa83a1819003910010a99a983c199ab9a33710a008900003d03c899911a981480591111a98200031111299a984100999ab9a3370e6a6aa0fc0104466607000600400266e0520000070840108301153353082013322333573466e1ccc0dc00400920010860108501335507f3535507e00822002488110465241434144415f56414c4944495459000011333301500948009200000a10830110830135355074500622002353550743032007220021332235302900b2322223530410072232232322533530860133301800900800715335308601333553041120013502f502e235355503f001223225335308b01333573466e1cd4d5421c05400888ccc1054030008005200008d0108c0115335308b01330385002011108c01108d01108c011335508601002001303b301a332233301d0290023302a480040054009401454cd4c21804c8d4c0d80608888d4c0e801488894cd4c23c04cc0f002001054cd4c23c04ccd5cd19b87007003091010900115335308f013335303b1200107f0060021333573466e1c01400424404240044240044240044240054cd4d41f0c0d14cd4d41f0cc0b4d4d5420805400c8800401c840044d42100526210011350840149854cd4c21804cc0e14015402c54cd4c21804cc0e14009402c54cd4c21804cccc0640352002480080384ccd5cd19b89335502b304112001303b301a5002480b02200421c04421c04421c04421c04421c04421c04421c044d4d54200054004880084cc09c0280044d4d541f4cc094020004880084cd541e0d4d541dc00488009220110465241434144415f56414c49444954590035355074500622002353550743032007220021353550700012233302a3535507250042200100200113530343033001222233550733037005001222333573466e20cd54058c0b048004d4c0dc0048888888888ccd54c04c48004894cd4c1f4ccd54c0e048004d4059405cc1b400803c4cd41c0008004400541bccc1a400d41bc0081c81cc8888d4c0cc00488894cd4c1d4ccd5cd19b87335501a3030120013301b0080030070770761333573466e1ccd54068c0c048004cc06c0200080181dc1d841d88ccc008038004cc03d2001335060335506a488100335060335506a489003330210014890048810050615061222335530111200123535506b00122335506e002335530141200123535506e001223355071002333535501100123300a4800000488cc02c0080048cc028005200000133004002001223355300f1200123535506900122335506c002333535500c0012335530131200123535506d001223355070002355013001001223335550080610020012335530131200123535506d00122335507000235501100100133355500305c00200111122233355300412001505f3355300f1200123535506900122335506c00235500f00133355300412001223535506a002225335307033355302b1200135009500a23535506d001223300a0020050061003133506300400350600013355300f120012353550690012232335506d00330010053200135507222533535063001135500f0032213535506f00222533530753300c00200813355014007001130060030023200135506b221122253353505f0011002221330050023335530071200100500400112335028223335350050032200200200135350030012200113350022253353068002106a10010671221233001003002120011121222300300411221222330020050041121222300100411200122337000040024466aa60062400246a6aa0ba0024466aa0c000466aa600c2400246a6aa0c00024466aa0c600466e08020004004004c8004d541808844894cd4d414c00454154884cd4158c010008cd54c0184800401000488c94cd4c17cccd5cd19b873355004301a120015001480081841804c94cd4d41480044d4178d4c168cd5ce249035054380005b49888400940044d41752613300400200111223333550023233501e22333501d0030010023501a00133501d22230033002001200122337000029001000a4000446a024244666aa02a446a60540044446a605e0064466a609e004400e4a66a60cc666ae68cdc780080603403389980519aa831802a99a9a82e0021080089a83224c00e200e002006446a60420024444444444a66a6a0b6666aa604024002a04646a6aa0c400244a66a60d0666ae68cdc780100783503489a8300018a82f801109a82f1a9aa831000910008a82e099a80191299a982d0010800882d82d0919a80c11199a9a802001910010010009a9a80100091000891091980080180109000990009aa82b910911299a9a8258010a99a9a825800882d91082e110a99a9a826801882e110a99a982e998038020010999a980489000803801800882f111a9aa828801111a9aa82980191299a982c999ab9a3371e0080040b60b426609200600220b4464646464646666666ae900188cccd5cd19b8735573aa00c900011999aab9f500625052233335573ea00c4a0a646666aae7d4018941508cccd55cfa8031282a91999aab9f35744a00e4a66a6a0aaa66a6a0aaa66a6a0aaa66a6a0aa646464646666666ae900108cccd5cd19b8735573aa008900011999aab9f50042505d233335573ea0084a0bc46666aae7cd5d128029299a9a82f182e9aba150072153353505f305e35742a00e426a0c466aa0ce0040022a0c02a0be4a0be0c40c20c04a0b8931282d9282d9282d9282d82f09aba25001135573ca00226ea8004d5d0a805909a82c11119998098020018010008a82b10a99a9a82b18089aba1500b2135059300200115057150562153353505632333333357480024a0b24a0b2460a66eb00089416494164170d5d0a805109a82c98010008a82b8a82b10a99a9a82b18089aba1500921350593002001150571505625056059058057056055250514989414094140941409414014c4d5d1280089aba25001135744a00226aae7940044dd50009111091999800802802001801100091999999aba4001250482504825048235049375a0044a09009644666ae68cdc399801801000a40040a40a2446a6aa0960024466600a0080040024446464600200a640026aa0a64466a6a0880029000111a9aa82800111299a982b199ab9a3371e0040120b00ae2600e0022600c006640026aa0a44466a6a0860029000111a9aa82780111299a982a999ab9a3371e00400e0ae0ac20022600c00646a004244666aa00a446a6aa09800444666aa012446a6aa0a000444a66a60ac666ae68cdc3800a40000b00ae2006266014666aaa01e00c0040020060060020020062466a002a07ca07e224464002640026aa09c44a66a6a07e00220064426600c004600800222244424666002008006004222400246a6016002446a601e0044444444444a66a6a092a6666a605601642a09642a09642a09642666aa601e24002a02446a603a00244a66a60aea66a60ae666ae68cdc79a981a001110011a981a0021100102c82c0999ab9a3370e6a6068004440026a6068008440020b20b020b026a09e0062a09c016426a6038002446a60400024446a604a0064466a608a004460aa2c4a66a6a0a40084266aa0b4004002260aa2c260982c640026aa0904422444a66a6a07800226a00c006442666a01200a6008004666aa600e2400200a008002246a6a00800244002246a6a00600244004266a00444a66a6a074004420062002a07224424660020060042400246a6008002446a60100044444444444646666020666666666602801601401201000e00c00a00800600400201401066aa60722400246a602a00244002014444424666600200a00800600440024424660020060044002444444444424666666666600201601401201000e00c00a0080060044002442466002006004400244424666002008006004400244246600200600440022442466002006004240022442466002006004240022442466002006004240022424446006008224440042244400224002424444600800a424444600600a424444600400a424444600200a40024424660020060044002424444444600e01044244444446600c012010424444444600a010244444440082444444400644244444446600401201044244444446600201201040024244600400644424466600200a008006400242446004006424460020064002640026aa02c442244a66a6a0120022a01644266a018600800466aa600c24002008002640026aa02a444a66a6a00e0042a012442a66a602e666a600c2400200e00400626600a002006266a0140046600a00266a014004006640026aa028442444a66a6a010002202e442a66a60306600a00400820342666a600e2400200a00800244666ae68cdc780100080a009990009aa809111999aab9f00123500a5006253353500830073574200442a66a6a01260086ae8800c84d4030cd401c00800454028540240304488008488488cc00401000c480048ccccccd5d20009280212802128021280211a8029bae002007121223002003112200112001235006353002335738921024c6700003498480048004448848cc00400c00844800449888ccd5cd19b870020010050041220021220012001112323001001223300330020020011'
const fracadaPolicyString = '59189059188d010000332323332223233322232323233322233223232332233332222332233223232323233223232323322323322332232323332223332223333333322222222333322223322332233223322332233223322332232323232323322323232333332222233223232323232323322323232333322223232323232323232323232323232323232323322230033002001222323253353084013300530120043333573466e1cd55cea8012400046605264646464646464646464646666ae68cdc39aab9d500a480008cccccccccc120cd404c8c8c8cccd5cd19b8735573aa0049000119827180e1aba150023018357426ae8940088d41d8d4c22404cd5ce249035054310008a0149926135573ca00226ea8004d5d0a80519a80980a1aba150093335501675ca02a6ae854020ccd54059d7280a9aba1500733501301c35742a00c66a02666aa04003aeb4d5d0a8029919191999ab9a3370e6aae754009200023350543232323333573466e1cd55cea80124000466a0b866a044eb4d5d0a80118119aba135744a00446a0f46a611a0266ae712401035054310008e0149926135573ca00226ea8004d5d0a8011919191999ab9a3370e6aae7540092000233505a33502275a6ae854008c08cd5d09aba2500223507a35308d013357389201035054310008e0149926135573ca00226ea8004d5d09aba25002235076353089013357389201035054310008a0149926135573ca00226ea8004d5d0a80219a809bae35742a00666a02666aa040eb807cd5d0a801180c9aba135744a00446a0e46a610a0266ae71240103505431000860149926135744a00226ae8940044d5d1280089aba25001135744a00226ae8940044d5d1280089aba25001135573ca00226ea8004d5d0a8011919191999ab9a3370ea002900311819180a1aba135573ca00646666ae68cdc3a8012400846062602c6ae84d55cf280211999ab9a3370ea00690011181898091aba135573ca00a46666ae68cdc3a80224000460686eb8d5d09aab9e500623506d35308001335738920103505431000810149926499264984d55cea80089baa001357426ae8940088d4198d4c1e4cd5ce249035054310007a49926107913502449010350543500135573ca00226ea800488c8c8c88c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c94ccd4c210054cd4d423804ccccccd5d200c11999ab9a3370ea02c900211999aab9f50182350930108a01250920108f0123333573466e1d405d2002233335573ea03246a12802112024a126021200246666ae68cdc3a80c2400046666aae7d406894250048cccd55cf9aba2501b253353509401323232323333333574800846666ae68cdc39aab9d5004480008cccd55cfa8021284e0091999aab9f50042509d01233335573e6ae89401494cd4d427404c8c8c8ccccccd5d200191999ab9a3370e6aae75400d2000233335573ea0064a1480246666aae7cd5d128021299a9a852009850809aba1500521350a701001150a501250a5010a2010a101250a301498942880494288049428804942880427c044d55cf280089baa00135742a00e42a66a6a13c02610e026ae85401c84d428404cc268040080045427c045427804942780426c0426804264049426c05262509a012509a012509a012509a0109701135744a00226aae7940044dd50009aba1501c213509701308d01001150950125095010920109101250930149926498942400494240049424004942400423404840044d41e52615335309801333573466e214005200009a010990115335309801333573466e1ccdc0a4000a0026a60eaa004444400613402132022a66a613002666ae68cdc39983c244110465241434144415f56414c494449545900500348004268042640454cd4c26004ccd5cd19b873355048307c1200150034801026804264044cccc11c065200248000d4d555420805401088880104264044264044264044264048c8c854cd4c26c04ccd5cd19b89500148000270042740454cd4c26c04ccd5cd19b87335504b307f12001500948010274042700454cd4c26c04ccd5cd19b873307b48910465241434144415f56414c494449545900500948008274042700454cd4c26c04cc0e1402d402054cd4c26c04cc0e1402d402054cd4c26c054cd4c26c04cc88d4d541fc00888d4d542040400c894cd4c28404ccd5cd19b8f0040020a3010a20113309b0100300110a201353078500c2222004335507e500a500215335309b01333573466e1cd4c1e14030888800d400427404270044ccd5cd19b87335504b307f12001353078500c2222002335504b307f12001323309501001509a01353078500c222200209d0109c01109c01109c0115335309b01353051500d222222222233355308901120013503d503f23322533530a801333573466e3cd4c2600400888008d4c26004004880082a8042a4044ccd5cd19b87353098010022200135309801001220010aa010a90110a90135305e0012200200e00a15335309b01333573466e20d4c22c0400c8800520800409d0109c011333304a01c480012002353555508501500f2222004109c01109c01109c01109c01109c01109c01109c01109c0113307a500150081372466e2cd4c2240400488004d4c224040048800854cd4c26004ccd5cd19b89500e48000264042680454cd4c26004cc88ccd54c1f848004d41c541c08d4d541f400488ccd54c2040448004d41d141cc8d4d542000400488ccd4d540d00048cc28005200000122330a1010020012330a00100148000004cc0ac008005403cd4d541e8d4c1d54040888801088cd425c04cd541f4008cd425c04cd541f4005404142600542600454cd4c26004ccd5cd19b87500e337026a60eaa66a6a11c0260e8a66a6a11c02660726a6aa0f4a01a44002a0224200226a0f2931080089a83ca4c44440066a60eaa020444400613402132022a66a6130026606a6a6aa0f4a0244400466aa0f6605002891110465241434144415f56414c494449545900153353098013333047019480092002353555550725013222220051333573466e24cd54120c1f048004c110c8c8cd54c0cc480048d4d541f400488cd5420004008cd54c0d8480048d4d542000400488cd5420c04008ccd4d540d00048cc29005200000122330a5010020012330a40100148000004cc0ac008004c8cd54c0cc480048d4d541f400488cd5420004008cd54c0d8480048d4d542000400488cd5420c04008cdc12400200200200266a12c0266aa0f891010033509601335507c48900333037001489004881005097015097013535507a500d22002480b026804264044264044264044264044264044264044cc1dcd4d541e4d4c1d14004888801088005400854cd4d423004c1c94cd4d423004cc0dcd4d541e0cc0d405cd4d5554200054008888800888004d4d5554200054008888800c840044d41dd26210011350774984cc100c094044d4d55541fd400488880044d4c120c0d80408888cccd555420c04c0e805001000c0044cd541d9400922110465241434144415f56414c49444954590013303d5001353555507c500622220011302100d135355072500322002153353508501306b533535085013303035355071500222001500121001135070498840044d41c126135355550785002222200313302c00e3535555077500122220021353040302e00822223333555507b303200c00400200113302a00c3535555506550062222200215335350860133035301a006500113506b498884d4d541b8008894cd4d42280400c54cd4c23804ccd5cd19b8f0023535507035306b50062222004220010900108f01100113506f498884d41c526135355555063500422222001153353507e306453353507e330293535506a500222001500121001135069498840044d41a526135355555061500222222004133025007353555550605001222220031353039302700122223333355555064302b005004003002001135573aa00426aae7940044dd50008919118011bac00132001355083012233335573e0024a10002466a0fe60086ae84008c00cd5d100103b11919191999ab9a3370e6aae75400d2000233303d3232323333573466e1cd55cea8012400046608660266ae854008cd4030048d5d09aba2500223506735307a3357389201035054310007b49926135573ca00226ea8004d5d0a801999aa803bae500635742a00466a010eb8d5d09aba25002235063353076335738921035054310007749926135744a00226aae7940044dd5000899aa800bae75a224464460046eac004c8004d542040488c8cccd55cf8011283f919a83f19aa83218031aab9d5002300535573ca00460086ae8800c1d44d5d080089119191999ab9a3370ea002900011a83b98029aba135573ca00646666ae68cdc3a801240044a0ee46a0c26a60e866ae7124010350543100075499264984d55cea80089baa001232323333573466e1cd55cea801240004660dc600a6ae854008dd69aba135744a00446a0bc6a60e266ae71241035054310007249926135573ca00226ea80048c8cccd5cd19b8735573aa002900011bae357426aae7940088d4170d4c1bccd5ce2490350543100070499261375400224464646666ae68cdc3a800a40084a08246666ae68cdc3a8012400446a088600c6ae84d55cf280211999ab9a3370ea00690001282211a82f9a983919ab9c490103505431000734992649926135573aa00226ea80048c8cccd5cd19b8750014800881ec8cccd5cd19b8750024800081ec8d416cd4c1b8cd5ce249035054310006f499264984d55ce9baa001232323232323333573466e1d4005200c204723333573466e1d4009200a204923333573466e1d400d2008233047375c6ae854014dd69aba135744a00a46666ae68cdc3a8022400c4660926eb8d5d0a8039bae357426ae89401c8cccd5cd19b875005480108cc138c030d5d0a8049bae357426ae8940248cccd5cd19b875006480088c140c034d5d09aab9e500b23333573466e1d401d20002304f300e357426aae7940308d418cd4c1d8cd5ce2481035054310007749926499264992649926135573aa00826aae79400c4d55cf280109aab9e5001137540024646464646666ae68cdc3a800a400446660966eb4d5d0a8021bad35742a0066eb4d5d09aba2500323333573466e1d400920002304d3008357426aae7940188d4170d4c1bccd5ce24810350543100070499264984d55cea80189aba25001135573ca00226ea80048c8c8cccd5cd19b875001480088c12cdd71aba135573ca00646666ae68cdc3a801240004609a6eb8d5d09aab9e500423505935306c3357389201035054310006d499264984d55cea80089baa00120011122232323333573466e1cd55cea80124000466aa0b4600c6ae854008c014d5d09aba2500223505835306b335738921035054310006c49926135573ca00226ea80048d4c050004894cccd4c06000484d4154d4c1a0cd5ce2481024c68000694988400484d4154d4c1a0cd5ce249024c680006949884d4154d4c1a0cd5ce2481024c680006949888cd54c028480048d4d5415000488cd5415c008ccd4d540200048cd54c038480048d4d5416000488cd5416c008d5403c00400488ccd5540201c00080048cd54c038480048d4d5416000488cd5416c008d54034004004ccd55400c1ac008004444888ccd54c0104800541b8cd54c028480048d4d5415000488cd5415c008d5402c004ccd54c0104800488d4d54154008894cd4c1d4ccd54c16448004d4035403c8d4d5416000488cc028008014018400c4cd41c801000d41bc004cd54c028480048d4d5415000488c8cd5416000cc004014c8004d541e0894cd4d41c80044d5402c00c884d4d54168008894cd4c1e8cc0300080204cd5404001c0044c01800c008c8004d541c488448894cd4d41b80044008884cc014008ccd54c01c480040140100044484888c00c01044884888cc0080140104484888c00401044800448cd414888ccd4d401800c88008008004d4d401000488004c8004d541ac8844894cd4d419c004541a4884cd41a8c010008cd54c018480040100044cd4008894cd4c1a000841a8400419c48848cc00400c0084800488ccd5cd19b8735355047001223330050040020014800819c198888c8c8c004014c8004d541a888cd4d41900052000223535504c002225335306c333573466e3c0080241b81b44c01c0044c01800cc8004d541a488cd4d418c0052000223535504b002225335306b333573466e3c00801c1b41b040044c01800c88c94cd4c190ccd5cd19b8733550143048120015001480081981944c94cd4d41840044d40152401035054380022100250011350454984cc05000800448d4108d4c154cd5ce00082b24c446a602e0024444444444a66a6a0c2666aa609e24002a0a446a6aa09c00244a66a60dc666ae68cdc780100783803789a8330018a832801109a8321a9aa827000910008a83111a9801000911a980b8011111111111191999810999999999981180580500480400380300280200180100080500419aa980a8900091a981200091000805110919800801801100090911118020029091111801802909111180100290911118008029000990009aa82d110891299a9a82b0008a82c11099a82c980200119aa980309000802000911a804891199aa806111a9aaa804001111299a982f199ab9a3371e0060120c00be26600e66aa0820040020082008002600a00646a00e244666aa014446a6aa07600444666aa01c446a6aa07e00444a66a60be666ae68cdc3800a40000c20c02006266014666aaa01a00c00400200600600200200622244424666002008006004222400244446a60120024444a66a60b2666ae68cdc399aa804981e890009980500400180382d82d0999ab9a3370e66aa012607a240026601401000400c0b60b420b422446666aa0046466a07844666a0760060020046a07000266a0764446006600400240024466e0000520020014800088d400c488ccd5401888d4c03c008888d4c05000c88cd4c0b4008801c94cd4c16cccd5cd19b8f00100c05d05c13300a335503e0055335350510042100113503c49801c401c00400c48cd4005413141344488c8004c8004d5414c894cd4d4134004400c884cc018008c010004888848cccc00401401000c0088004888888888848cccccccccc00402c02802402001c01801401000c00880048848cc00400c008800488848ccc00401000c00880048848cc00400c008800448848cc00400c0084800448848cc00400c0084800448848cc00400c00848004484888c00c010448880084488800448004848888888c01c0208848888888cc018024020848888888c014020488888880104888888800c8848888888cc0080240208848888888cc00402402080048488c00800c888488ccc00401401000c80048488c00800c8488c00400c80044cd400c894cd4c0b0008400440b40b048cd404c88ccd4d401000c88008008004d4d40080048800448848cc00400c00848004444448888848ccccc00401801401000c0084444480048c8c8c8c8c8ccccccd5d200311999ab9a3370e6aae7540192000233335573ea00c4a04846666aae7d4018940948cccd55cfa8031281311999aab9f500625027233335573e6ae89401c94cd4d409cc8c8c8c8ccccccd5d200211999ab9a3370e6aae7540112000233335573ea0084a05e46666aae7d4010940c08cccd55cf9aba250052533535030302d35742a00e42a66a6a062605c6ae85401c84d40d0cd5407c008004540c8540c4940c40b80b40b0940b9262502d2502d2502d2502d02a135744a00226aae7940044dd50009aba1500b21533535028301135742a01642a66a6a052646666666ae90004940b0940b08c09cdd600112816128160149aba1500b2153353502a301335742a016426a05a66660260080060040022a0562a0542a0522a0504a05004a0480460440424a046931281112811128111281100f89aba25001135744a00226ae8940044d55cf280089baa001222212333300100500400300220012333333357480024a0344a0344a03446a0366eb40089406805c88d4d540114cd4d4060ccd54c01848005402494cd4c08cd4d5401400488cc07c0080144d406c00454068004840044d400d26220011261122123300100300211200132001355020221122253353501d00113500600322133350090053004002333553007120010050040011235350040012200112353500300122002133500222533535011002210031001501012212330010030021200111112222123333001005004003002111120011222003212223002004122200120012212330010030022001320013550122233335573e00246a012a01e4a66a6a00e60086ae84008854cd4d4020c010d5d1001909a80599a8080010008a8048a80400291999999aba400125006250062500625006235007375c004006240024002242446004006224400224002640026aa016444a66a6a00c0042a010442a66a6018666a600e2400200c00400626600a002006266a0120046600a00266a01200400644666ae68cdc7801000805004990009aa804910911299a9a8030008805910a99a98061980280100208070999a9803890008028020008891001091091198008020018900091199ab9a3370e00400200a00824400424400240024466e00008004448c8c00400488cc00cc0080080052211c4f754329112f8a700fe4ae2328c8c104324ee5f8b7e961495375ad330001'

const fracadaParams = (initTokenClass: [arg0: string, arg1: string]) => {
    let asset = new Constr(0, [initTokenClass[0], initTokenClass[1]])
    return new Constr(0, [asset, [], BigInt(1)])
}

const fracadaValidator = (initTokenClass: [arg0: string, arg1: string]): Script => {
    return {
        type: 'PlutusV1',
        script: applyParamsToScript(
            fracadaScript,
            fracadaParams(initTokenClass)
        )
    }
}

const fracadaPolicy = (lucid: Lucid, initTokenClass: [arg0: string, arg1: string]): Script => {
    return {
        type: 'PlutusV1',
        script: applyParamsToScript(
            fracadaPolicyString,
            lucid.utils.validatorToScriptHash(fracadaValidator(initTokenClass)),
            `Fracada-${initTokenClass[1]}`
        )
    }
}

// Datum Stuff.
const fracadaDatum = (initTokenClass: [arg0: string, arg1: string], fractions: number) => {
    let asset = new Constr(0, [initTokenClass[0], initTokenClass[1]])
    return new Constr(0, [asset, BigInt(fractions), asset])
} // We want to store relevant datum info in the metadata.

const fracadaRedeemer = () => {
    return new Constr(1, []) // Nothing
}

// Actions
// TODO We may want to make it so that we query for the tx where we minted the fracada tokens, easier for UX, otherwise user must provide nft that was used.
export const unlockNft = async (lucid: Lucid, initTokenClass: [arg0: string, arg1: string]) => {
    try {
        let tx = lucid.newTx()
        const policy = fracadaPolicy(lucid, initTokenClass)
        const validator = fracadaValidator(initTokenClass)
        const validatorAddress = lucid.utils.validatorToAddress(validator)
        const fracadaToken = `${lucid.utils.mintingPolicyToId(policy)}Fracada-${initTokenClass[1]}`

        // Get UTxOs with fraction token present. 
        const userUtxos = await lucid.wallet.getUtxos()
        let fullAmount = 0
        const withPolicy = userUtxos.filter((v) => {
            const assets = v.assets
            const amountOfAsset = assets[fracadaToken] // Returns 0 when not present hopefully?
            fullAmount += Number(amountOfAsset)
            return amountOfAsset > BigInt(0)
        })

        // Search for the asset in the validator.
        const scriptUtxos = await lucid.utxosAt(validatorAddress)
        const withAsset = scriptUtxos.filter((v) => {
            const assets = v.assets
            const amountOfAsset = assets[`${initTokenClass[0]}${initTokenClass[1]}`] // Returns 0 when not present hopefully?
            return amountOfAsset > BigInt(0)
        })
        if (withAsset.length != 1) {
            throw "The locked UTxO was not found."
        }
        let scriptUtxo = withAsset[0]
        scriptUtxo.datum = Data.to(fracadaDatum(initTokenClass, fullAmount))

        const datum = fracadaDatum(initTokenClass, fullAmount)
        const redeemer = fracadaRedeemer()
        const toBurn: Assets = {
            [fracadaToken]: BigInt(0 - fullAmount)
        }

        tx = tx.collectFrom([scriptUtxo], Data.to(redeemer))
            .collectFrom(withPolicy)
            .mintAssets(toBurn, Data.empty())
            .attachSpendingValidator(validator)
            .attachMintingPolicy(policy)

        // Sign and submit
        let txC = await tx.complete()
        let txS = await txC.sign().complete()
        let txHash = await txS.submit()
        return txHash
    } catch (e) {
        throw e
    }
}

export const fractionalizeNft = async (lucid: Lucid, initTokenClass: [arg0: string, arg1: string], fractions: number) => {
    try {
        let tx = lucid.newTx()
        const policy = fracadaPolicy(lucid, initTokenClass)
        const validator = fracadaValidator(initTokenClass)
        const validatorAddress = lucid.utils.validatorToAddress(validator)
        const fracadaToken = `${lucid.utils.mintingPolicyToId(policy)}Fracada-${initTokenClass[1]}`

        const datum = fracadaDatum(initTokenClass, fractions)
        const nftUnit = `${initTokenClass[0]}${initTokenClass[1]}`
        const payment = {['lovelace']: BigInt(2000000), [nftUnit]: BigInt(1)}

        tx = tx.payToContract(validatorAddress, Data.to(datum), payment)
            .mintAssets({[fracadaToken]: BigInt(fractions)}, Data.empty())
            .attachMintingPolicy(policy)

        // Sign and submit
        let txC = await tx.complete()
        let txS = await txC.sign().complete()
        let txHash = await txS.submit()
        return txHash
    } catch (e) {
        throw e
    }
}